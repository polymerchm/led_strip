# Sparkle - a 20-NEOPIXEL LED "Firefly" Lights

## Summary

This app will program a 20-pixel LED strand to randomly pulse sets of the LEDS with a gaussian intensity profile of a prescribed std-dev at varying start times.

The "pulses" are all contained within the total "repeat time" by preventing a median from being any closer to the start or end than 3 std_devs.

There are two tasks, one for building the sequences of intensities
on all of the LEDS and one to display the LEDS. The build task runs on CPU0 and the Display task runs on CPU1.   They coordinate using the xTaskNotify and xTaskNotifyWait functions.

Once a pattern is stored, it is displayed (using the RMT hardware) while the next pattern is created   When the new "image" is ready, it will signal the display task to use it.    The display task signals the build task to generate the next pattern in the other buffer.

20 NEOPIXELS is about the limit for an ESP32 WROOM-32e (uses 75% of memory).


### Future

Other patterns triggered by a touch switch

## Based on the following.

| Supported Targets | ESP32 | ESP32-C3 | ESP32-C5 | ESP32-C6 | ESP32-H2 | ESP32-P4 | ESP32-S2 | ESP32-S3 |
| ----------------- | ----- | -------- | -------- | -------- | -------- | -------- | -------- | -------- |
# RMT Transmit Example -- LED Strip

(See the README.md file in the upper level 'examples' directory for more information about examples.)

Almost any waveform can be generated by RMT peripheral, as long as a proper encoder is implemented. The RMT encoder is used to encode user data (e.g. RGB pixels) into format that can be recognized by hardware.

This example shows how to drive an addressable LED strip [WS2812](https://cdn-shop.adafruit.com/datasheets/WS2812B.pdf) by implementing the [led_strip_encoder](main/led_strip_encoder.c).

## How to Use Example

### Hardware Required

* A development board with any supported Espressif SOC chip (see `Supported Targets` table above)
* A USB cable for Power supply and programming
* A WS2812 LED strip

Connection :

```
                              --- 5V
                               |
                               +
RMT_LED_STRIP_GPIO_NUM +------ +---|>| (WS2812 LED strip)
                        DI     +
                               |
                              --- GND
```

The GPIO number used in this example can be changed according to your board, by the macro `RMT_LED_STRIP_GPIO_NUM` defined in the [source file](main/led_strip_example_main.c). The number of LEDs can be changed as well by `EXAMPLE_LED_NUMBERS`.

### Build and Flash

Run `idf.py -p PORT flash monitor` to build, flash and monitor the project.

(To exit the serial monitor, type ``Ctrl-]``.)

See the [Getting Started Guide](https://docs.espressif.com/projects/esp-idf/en/latest/get-started/index.html) for full steps to configure and use ESP-IDF to build projects.

## Console Output

```
I (302) cpu_start: Starting scheduler on PRO CPU.
I (0) cpu_start: Starting scheduler on APP CPU.
I (323) example: Create RMT TX channel
I (343) example: Install led strip encoder
I (353) example: Start LED rainbow chase
```


After you seeing this log, you should see a rainbow chasing demonstration pattern. To change the chasing speed, you can update the `EXAMPLE_CHASE_SPEED_MS` value in [source file](main/led_strip_example_main.c).

## Troubleshooting

For any technical queries, please open an [issue] (https://github.com/espressif/esp-idf/issues) on GitHub. We will get back to you soon.

